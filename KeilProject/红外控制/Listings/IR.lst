C51 COMPILER V9.54   IR                                                                    10/04/2023 13:31:13 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE IR
OBJECT MODULE PLACED IN .\Objects\IR.obj
COMPILER INVOKED BY: F:\Keli5\C51\BIN\C51.EXE IR.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\IR.lst) 
                    -TABS(2) OBJECT(.\Objects\IR.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "Timer0.h"
   3          #include "Int0.h"
   4          sbit IRIN=P3^2;
   5          unsigned int IR_Time;  //ËÆ°Êó∂
   6          unsigned char IR_State; //ÂÆö‰πâÁä∂ÊÄÅ
   7          
   8          unsigned char IR_Data[4];//Ë°®Á§∫Âõõ‰∏™Â≠óËäÇ
   9          unsigned char IR_pData;//Áî®‰∫éËÆ∞ÂΩïÊòØ‰∏çÊòØÊää32‰ΩçÊï∞ÊçÆÂÖ®ÈÉ®Êî∂Âà∞ÔºåÊ†áÂøó
  10          
  11          unsigned char IR_DataFlag;//Â∞±Â∞±ÊòØÂ¶ÇÊûúÊï∞ÊçÆÂ¶ÇÊûúÊî∂Âà∞‰∫ÜÔºåÂ∞±ÁΩÆ1„ÄÇÁî®‰∫éÂú®‰∏ªÂáΩÊï∞‰∏≠ËøõË°åÂà
             -§Êñ≠
  12          unsigned char IR_RepeatFlag;//ÈáçÂèëÊ†áÂøó‰Ωç
  13          
  14          unsigned char IR_Address;//Â≠òÊúÄÁªàÁöÑÁªìÊûú
  15          unsigned char IR_Command;//ÂëΩ‰ª§Á†Å
  16          
  17          void IR_Init(void)
  18          {
  19   1        Timer0_Init();//ÂÆöÊó∂Âô®ÂàùÂßãÂåñ
  20   1        Int0_Init();// ‰∏≠Êñ≠ÂàùÂßãÂåñ
  21   1       
  22   1      }
  23          unsigned char IR_GetDataFlag(void)
  24          {
  25   1       if(IR_DataFlag)
  26   1       {
  27   2        IR_DataFlag=0;
  28   2         return 1;
  29   2       }
  30   1       return 0;
  31   1      }
  32          unsigned char IR_GetRepeatFlag(void)
  33          {
  34   1       if(IR_RepeatFlag)
  35   1       {
  36   2        IR_RepeatFlag=0;
  37   2        return 1;
  38   2       }
  39   1       return 0;
  40   1      }
  41          
  42          
  43          unsigned char IR_GetAddress(void)
  44          {
  45   1       return IR_Address;
  46   1      }
  47          
  48          unsigned char IR_GetCommand(void)
  49          {
  50   1       return IR_Command;
  51   1      }
  52          void Int0_Routine(void) interrupt 0
  53          {
C51 COMPILER V9.54   IR                                                                    10/04/2023 13:31:13 PAGE 2   

  54   1         //Âõ†‰∏∫ÊúÄÂºÄÂßãËøô‰∏™Áä∂ÊÄÅÊó∂Á©∫Èó≤Áä∂ÊÄÅÔºåÂÆö‰πâ‰∏∫0,Ë°®Á§∫Ê≠§Êó∂Á©∫Èó≤
  55   1        if((IR_State==0)&&(IRIN==1))
  56   1        {
  57   2          Timer0_SetCounter(0);//Á°Æ‰øùËøô‰∏™ËÆ°Êï∞Âô®‰ªé0ÂºÄÂßã
  58   2          Timer0_Run(1);//ÂèÇÊï∞1Ë°®Á§∫ËÆ°Êï∞Âô®ÂºÄÂßãËÆ°Êï∞
  59   2          IR_State=1;
  60   2        }
  61   1        //Ê≠§Êó∂Â∞±ÊòØÂΩì‰∏ä‰∏ÄÊ¨°Ëøõ‰∏≠Êñ≠‰πãÂêéÔºåËøô‰∏™Áä∂ÊÄÅË¢´ËÆæÁΩÆ‰∫Ü
  62   1        //ÁÑ∂Âêé‰∏ã‰∏ÄÊ¨°Ëøõ‰∏≠Êñ≠ÔºåÂõ†‰∏∫Ëøô‰∏™IR_sTATE==1,ÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ËøõË°åÊï∞ÂÖ∂‰∏≠ÁöÑÈó¥ÈöîÊó∂Èó¥Â∞±Â
             -èØ‰ª•‰∫Ü
  63   1        
  64   1        else if(IR_State==1)
  65   1        {
  66   2          IR_Time=Timer0_GetCounter();//ËØªÂà∞‰ªéÈ´òÁîµÂπ≥Âà∞‰ΩéÁîµÂπ≥ÔºåÂèàÊòØÈ´òÁîµÂπ≥ÁöÑÊó∂Èó¥Èó¥Èöî
  67   2          Timer0_SetCounter(0);//Ê∏Ö0.Êñπ‰æø‰∏ã‰∏ÄÊ¨°ËÆ°Êó∂
  68   2           /*
  69   2            Ê†πÊçÆNECÁºñÁ†ÅÂèØ‰ª•ÂæóÂà∞ÔºåËøô‰∏™StartÊ†áÂøóÁöÑÊó∂Èó¥Ôºå‰ª•ÂèärepeatÊ†áÂøóÁöÑÊó∂Èó¥
  70   2          ‰ª•Ê≠§Êù•ËøõË°åÂà§Êñ≠Ëøô‰∏™ÊòØ‰ªÄ‰πà
  71   2          */
  72   2          //‰∏∫‰ªÄ‰πàÊòØ‰∏Ä‰∏™ËåÉÂõ¥ÔºåÂõ†‰∏∫Ëøô‰∏™ÊåâÈîÆÂèØËÉΩÊúâÊäñÂä®ÔºåÊâÄ‰ª•Êó∂Èó¥‰∏çÂèØËÉΩÊòØÂàöÂ•Ω13500ÂæÆÁ
             -ßí
  73   2          if(IR_Time>13500-500 && IR_Time<13500+500)
  74   2          {
  75   3            
  76   3            IR_State=2;//Ë°®Á§∫‰∏ã‰∏ÄÊ¨°ÂÜçÊù•‰∏≠Êñ≠Â∞±Ë¶ÅÂºÄÂßãËß£Á†ÅÊï∞ÊçÆÈÉ®ÂàÜ‰∫Ü
  77   3          }else if(IR_Time>11250-500 && IR_Time<11250+500)
  78   2          {
  79   3            //Êé•ÂèóÂà∞Ëøô‰∏™‰ø°Âè∑Ë°®Á§∫Ëøô‰∏ÄÂ∏ßÂ∑≤ÁªèÁªìÊùü‰∫ÜÔºåÂêéÈù¢Â∑≤Áªè‰∏ç‰ºö‰ΩøÁî®Êï∞ÊçÆ‰∫Ü
  80   3            IR_RepeatFlag=1;
  81   3            //ÂÅúÊ≠¢ËÆ°Êó∂Âô®
  82   3            Timer0_Run(0);
  83   3            IR_State=0;//‰ªéÊñ∞ÊääËøô‰∏™Áä∂ÊÄÅÁΩÆ‰Ωç0
  84   3          }
  85   2          else
  86   2          {
  87   3            //Ëß£Á†ÅÈîôËØØÊâç‰ºöÂá∫Áé∞
  88   3            IR_State=1;
  89   3          }
  90   2        }
  91   1        //ÂºÄÂßãËß£Á†Å
  92   1        else if(IR_State==2)
  93   1        {
  94   2        IR_Time=Timer0_GetCounter();
  95   2        Timer0_SetCounter(0);
  96   2          //ËøôÊòØÈÄªËæë0ÁöÑ
  97   2         if(IR_Time>1120-500 && IR_Time<1120+500)
  98   2          {
  99   3            /*
 100   3            ÊØè‰∏ÄÊ¨°ÈÉΩÊòØÂõõ‰∏™Â≠óËäÇÁöÑÊï∞ÊçÆÔºå‰ª•Ê≠§Â≠òÂèñ32‰Ωç
 101   3            */
 102   3             IR_Data[IR_pData/8] &= ~(0x01<<(IR_pData%8));
 103   3            IR_pData++;
 104   3          }
 105   2            //ËøôÊòØÈÄªËæë1ÁöÑ
 106   2         else if(IR_Time>2250-500 && IR_Time<2250+500)
 107   2          {
 108   3            /*
 109   3            ÊØè‰∏ÄÊ¨°ÈÉΩÊòØÂõõ‰∏™Â≠óËäÇÁöÑÊï∞ÊçÆÔºå‰ª•Ê≠§Â≠òÂèñ32‰Ωç
 110   3            */
 111   3             IR_Data[IR_pData/8] &= ~(0x01<<(IR_pData%8));
 112   3            IR_pData++;
 113   3          }
C51 COMPILER V9.54   IR                                                                    10/04/2023 13:31:13 PAGE 3   

 114   2          else{
 115   3          IR_pData=0;
 116   3          IR_State=1;
 117   3          }
 118   2          //Âõ†‰∏∫ËøôÊòØË°®Á§∫ËÆ°ÁÆóÊï∞ÊçÆ‰ΩçÊï∞ÁöÑÔºå‰∏îËøô‰∏™Êï∞ÊçÆÊòØ32‰ΩçÔºåÊâÄ‰ª•Âà§Êñ≠ÊòØ‰∏çÊòØÊî∂ÁªìÊùü‰∫Ü
 119   2          if(IR_pData>=32)
 120   2          {
 121   3           IR_pData=0;
 122   3            //Ê†πÊçÆÂô®NECÁºñÁ†ÅÂæóÂà∞ÁöÑ
 123   3             if((IR_Data[0]==~IR_Data[1]) && (IR_Data[2]==~IR_Data[3]) )
 124   3             {
 125   4               //‰∏äËø∞Âà§Êñ≠ËØ¥ÊòéÊï∞ÊçÆÈ™åËØÅÊ≠£Á°Æ
 126   4               //ÊääÊï∞ÊçÆËΩ¨Â≠òËøáÂéª
 127   4               IR_Address=IR_Data[0];
 128   4               IR_Command=IR_Data[2];
 129   4               IR_DataFlag=1;//ÂëäËØâ‰ªñÂ∑≤ÁªèÊî∂Âà∞Êï∞ÊçÆ‰∫Ü
 130   4             }
 131   3           Timer0_Run(0);
 132   3           IR_State=0;
 133   3          }
 134   2        }
 135   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    372    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
